pred w i:term, o:ty.

% terms
w (app H A) (mono T) :-
  w H (mono TH),
  w A (mono TA),
  assert H TH (TA ==> T).

w (lam F) (mono (S ==> T)) :-
  pi x\ w x (mono S) => w (F x) (mono T).

w (let E PT B) (mono TB) :-
  w E (mono T),
  gammabar (mono T) PT,
  pi x\ w x PT => w (B x) (mono TB).

w (eq LHS RHS) (mono bool) :-
  w LHS (mono TL),
  w RHS (mono TR),
  eqbar TL,
  assert RHS TR TL.

w X (mono T) :- w X (all E Poly), specialize (all E Poly) T1, assert X T T1.

