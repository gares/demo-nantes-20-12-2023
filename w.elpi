pred w i:term, o:ty.

% terms
w (app H A) (mono T) :-
  w H (mono (S ==> T)),
  w A (mono S).

w (lam F) (mono (S ==> T)) :-
  pi x\ w x (mono S) => w (F x) (mono T).

w (let E PT B) (mono TB) :-
  w E (mono T),
  gammabar (mono T) PT,
  pi x\ w x PT => w (B x) (mono TB).

w (eq LHS RHS) (mono bool) :-
  w LHS (mono T),
  w RHS (mono T),
  eqbar T.

w X (mono T) :- w X (all E Poly), specialize (all E Poly) T.

